{
    "collab_server" : "",
    "contents" : "library(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\n\nbeer_reviews <- read.csv(\"beer_reviews.csv\", sep = \",\", header = TRUE, encoding = \"UTF-8\")\nbreweries <- beer_reviews %>% group_by(brewery_name) %>% summarize(n_obs = n()) %>% filter(n_obs > 50) #%>% select(brewery_name)\nstyles <- beer_reviews %>% group_by(beer_style) %>% summarize(n_obs = n()) %>% filter(n_obs > 50) #%>% select(beer_style)\nbeers <- beer_reviews %>% group_by(beer_name) %>% summarize(n_obs = n()) %>% filter(n_obs > 50) #%>% select(beer_name)\n\nhist(beer_reviews$review_overall,\n     col = \"blue\",\n     breaks = 5,\n     xlab = \"Beer Rating Score\",\n     ylab = \"Number of Reviews\",\n     main = \"Beer Review Rating Distribution\",\n     labels = TRUE,\n     ylim = c(0,900000)\n     \n     \n)\n\nggplot(beer_reviews, aes(beer_reviews$review_overall)) + \n  geom_histogram(aes(fill = ..count..)) +\n  theme_bw() + \n  ggtitle(\"Beer Review Distribution\") +\n  labs(x = \"Beer Review Score\", y = \"Number of Reviews\") +\n  ylim(0, 900000)\nggsave(\"beer_review_distribution.png\")\n\nzzz <- beer_reviews %>%\n  select(brewery_name, review_overall, beer_abv) %>%\n  group_by(brewery_name) %>%\n  summarize(n_obs = n(),\n            avg_rating = mean(review_overall),\n            avg_abv = mean(beer_abv, na.rm = TRUE)) %>%\n  filter(n_obs > 50) %>%\n  arrange(desc(avg_rating))\n\nxxx <- beer_reviews %>%\n  select(beer_style, review_overall, beer_abv) %>%\n  group_by(beer_style) %>%\n  summarize(n_obs = n(),\n            avg_rating = mean(review_overall),\n            avg_abv = mean(beer_abv, na.rm  =TRUE)) %>%\n  filter(n_obs > 50) %>%\n  arrange(desc(avg_rating))\n\nbeer_reviews %>%\n  select(beer_name, review_overall) %>%\n  group_by(beer_name) %>%\n  summarize(n_obs = n(),\n            avg_rating = mean(review_overall)) %>%\n  filter(n_obs > 100) %>%\n  arrange(desc(avg_rating))\n\n## recommend best: based on brewery/type/beer, n = number of recommendations, reviews = min. number of reviews\nbest_recommendation <- function(x = c(\"brewery\", \"type\", \"beer\"), n, reviews){\n  if (x == \"brewery\"){\n    beer_reviews %>%\n      #select(brewery_name, review_overall) %>%\n      group_by(brewery_name) %>%\n      summarize(n_obs = n(),\n                avg_rating = mean(review_overall)) %>%\n      filter(n_obs > reviews) %>%\n      arrange(desc(avg_rating)) %>%\n      select(brewery_name, avg_rating) %>%\n      head(n)\n  }\n  else if (x == \"type\"){\n    beer_reviews %>%\n      group_by(beer_style) %>%\n      summarize(n_obs = n(),\n                avg_rating = mean(review_overall)) %>%\n      filter(n_obs > reviews) %>%\n      arrange(desc(avg_rating)) %>%\n      select(beer_style, avg_rating) %>%\n      head(n)\n  }\n  else if (x == \"beer\"){\n    beer_reviews %>%\n      group_by(beer_name) %>%\n      summarize(n_obs = n(),\n                avg_rating = mean(review_overall)) %>%\n      filter(n_obs > reviews) %>%\n      arrange(desc(avg_rating)) %>%\n      select(beer_name, avg_rating) %>%\n      head(n)\n  }\n}\n\nbeer_reviews %>%\n  group_by(beer_style) %>%\n  summarize(n_obs = n(),\n            avg_rating = round(mean(review_overall), digits=2),\n            avg_abv = round(mean(beer_abv, na.rm = TRUE), digits=2)) %>%\n  filter(n_obs >= 100) %>%\n  filter(avg_abv >= min(0.1) & avg_abv <= max(3)) %>%\n  #select(beer_style, avg_rating, avg_abv) %>%\n  #arrange(desc(avg_rating)) %>%\n  top_n(10, avg_rating)\n\nbeer_reviews %>%\n  group_by(brewery_name) %>%\n  summarize(n_obs = n(),\n            avg_rating = round(mean(review_overall), digits=2),\n            avg_abv = mean(beer_abv)) %>%\n  filter(n_obs >= 100) %>%\n  filter(avg_abv >= min(4) & avg_abv <= max(6)) %>%\n  arrange(desc(avg_rating)) %>%\n  select(brewery_name, avg_rating, avg_abv) %>%\n  top_n(10)\n\nbrewery2 <- beer_reviews %>%\n  filter(beer_style == \"American Brown Ale\") %>%\n  group_by(brewery_name) %>%\n  summarize(n_obs = n(),\n            avg_rating = round(mean(review_overall), digits=2),\n            avg_abv = round(mean(beer_abv, na.rm = TRUE), digits=2)) %>%\n  filter(n_obs >= 100) %>%\n  filter(avg_abv >= 4.5, avg_abv <= 7) %>%\n  top_n(n = 15, wt = avg_rating) %>%\n  arrange(desc(avg_rating))\n",
    "created" : 1490264385533.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2334599721",
    "id" : "5AEA2086",
    "lastKnownWriteTime" : 1490269503,
    "last_content_update" : 1490269503605,
    "path" : "~/HIS - Data Science/Data Mining/Project/beer-recommender.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}